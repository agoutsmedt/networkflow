<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a data.frame suitable for alluvial graph projection — networks_to_alluv • networkflow</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a data.frame suitable for alluvial graph projection — networks_to_alluv"><meta name="description" content="This function creates a data.frame that can be easily plotted with ggalluvial from a list of networks."><meta property="og:description" content="This function creates a data.frame that can be easily plotted with ggalluvial from a list of networks."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">networkflow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/exploring_dynamic_networks.html">Exploring dynamic networks</a></li>
    <li><a class="dropdown-item" href="../articles/workflow-network.html">A Workflow for network analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/agoutsmedt/networkflow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a data.frame suitable for alluvial graph projection</h1>
      <small class="dont-index">Source: <a href="https://github.com/agoutsmedt/networkflow/blob/master/R/networks_to_alluv.R" class="external-link"><code>R/networks_to_alluv.R</code></a></small>
      <div class="d-none name"><code>networks_to_alluv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a data.frame that can be easily plotted with ggalluvial from a list of networks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">networks_to_alluv</span><span class="op">(</span></span>
<span>  <span class="va">graphs</span>,</span>
<span>  <span class="va">intertemporal_cluster_column</span>,</span>
<span>  <span class="va">node_id</span>,</span>
<span>  summary_cluster_stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep_color <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color_column <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>  keep_cluster_label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cluster_label_column <span class="op">=</span> <span class="st">"cluster_label"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graphs">graphs<a class="anchor" aria-label="anchor" href="#arg-graphs"></a></dt>
<dd><p>A tibble graph from <a href="https://tidygraph.data-imaginist.com/" class="external-link">tidygraph</a> or a list of tibble
graphs.</p></dd>


<dt id="arg-intertemporal-cluster-column">intertemporal_cluster_column<a class="anchor" aria-label="anchor" href="#arg-intertemporal-cluster-column"></a></dt>
<dd><p>The column with the identifier of the inter-temporal cluster. If you have used
<a href="add_clusters.html">add_clusters()</a> and <a href="merge_dynamic_clusters.html">merge_dynamic_clusters()</a>,
it is of the form <code>dynamic_cluster_{clustering_method}</code>.</p></dd>


<dt id="arg-node-id">node_id<a class="anchor" aria-label="anchor" href="#arg-node-id"></a></dt>
<dd><p>The column with the unique identifier of each node.</p></dd>


<dt id="arg-summary-cluster-stats">summary_cluster_stats<a class="anchor" aria-label="anchor" href="#arg-summary-cluster-stats"></a></dt>
<dd><p>If set to <code>TRUE</code>, the data.frame will contain a list of variable that summarize cluster statistics of the alluvial. These variables
can be particularly useful to filter smaller communities when plotting according to different variables:</p><ul><li><p><code>share_cluster_alluv</code> is the percentage share of a given cluster across all time windows;</p></li>
<li><p><code>share_cluster_window</code> is the percentage share of a given cluster in a given time window;</p></li>
<li><p><code>share_cluster_max</code> is the highest value of <code>share_cluster_window</code> for a given cluster across all individual time windows;</p></li>
<li><p><code>length_cluster</code> is the number of time windows a cluster exists.</p></li>
</ul></dd>


<dt id="arg-keep-color">keep_color<a class="anchor" aria-label="anchor" href="#arg-keep-color"></a></dt>
<dd><p>Set to <code>TRUE</code> (by default) if you want to keep the column with the color associated to
the different categories of <code>intertemporal_cluster_column</code>. Such a column exists in your
list of tibble graphs if you have use <a href="color_networks.html">color_networks()</a>.</p></dd>


<dt id="arg-color-column">color_column<a class="anchor" aria-label="anchor" href="#arg-color-column"></a></dt>
<dd><p>The name of the column with the colors of the categories in <code>intertemporal_cluster_column</code>.
By default, "color", as it is the column name resulting from the use of
<a href="color_networks.html">color_networks()</a>.</p></dd>


<dt id="arg-keep-cluster-label">keep_cluster_label<a class="anchor" aria-label="anchor" href="#arg-keep-cluster-label"></a></dt>
<dd><p>Set to <code>TRUE</code> if you want to keep the column with a name/label associated to the
different categories of <code>intertemporal_cluster_column</code>. Such a column exists in your
list of tibble graphs if you have use <a href="name_clusters.html">name_clusters()</a>.</p></dd>


<dt id="arg-cluster-label-column">cluster_label_column<a class="anchor" aria-label="anchor" href="#arg-cluster-label-column"></a></dt>
<dd><p>The name of the column with the name/label associated to the categories in
<code>intertemporal_cluster_column</code>. By default, "cluster_label", as it is the column name
resulting from the use of <a href="name_clusters.html">name_clusters()</a>.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/agoutsmedt/networkflow" class="external-link">networkflow</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="va">Nodes_stagflation</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ID_Art <span class="op">=</span> <span class="va">ItemID_Ref</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"Stagflation"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">references</span> <span class="op">&lt;-</span> <span class="va">Ref_stagflation</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ID_Art <span class="op">=</span> <span class="va">Citing_ItemID_Ref</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temporal_networks</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_dynamic_networks.html">build_dynamic_networks</a></span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">nodes</span>,</span></span>
<span class="r-in"><span>directed_edges <span class="op">=</span> <span class="va">references</span>,</span></span>
<span class="r-in"><span>source_id <span class="op">=</span> <span class="st">"ID_Art"</span>,</span></span>
<span class="r-in"><span>target_id <span class="op">=</span> <span class="st">"ItemID_Ref"</span>,</span></span>
<span class="r-in"><span>time_variable <span class="op">=</span> <span class="st">"Year"</span>,</span></span>
<span class="r-in"><span>cooccurrence_method <span class="op">=</span> <span class="st">"coupling_similarity"</span>,</span></span>
<span class="r-in"><span>time_window <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>edges_threshold <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>overlapping_window <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>filter_components <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temporal_networks</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_clusters.html">add_clusters</a></span><span class="op">(</span><span class="va">temporal_networks</span>,</span></span>
<span class="r-in"><span>objective_function <span class="op">=</span> <span class="st">"modularity"</span>,</span></span>
<span class="r-in"><span>clustering_method <span class="op">=</span> <span class="st">"leiden"</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temporal_networks</span> <span class="op">&lt;-</span> <span class="fu"><a href="merge_dynamic_clusters.html">merge_dynamic_clusters</a></span><span class="op">(</span><span class="va">temporal_networks</span>,</span></span>
<span class="r-in"><span>cluster_id <span class="op">=</span> <span class="st">"cluster_leiden"</span>,</span></span>
<span class="r-in"><span>node_id <span class="op">=</span> <span class="st">"ID_Art"</span>,</span></span>
<span class="r-in"><span>threshold_similarity <span class="op">=</span> <span class="fl">0.51</span>,</span></span>
<span class="r-in"><span>similarity_type <span class="op">=</span> <span class="st">"partial"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temporal_networks</span> <span class="op">&lt;-</span> <span class="fu"><a href="name_clusters.html">name_clusters</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">temporal_networks</span>,</span></span>
<span class="r-in"><span>method <span class="op">=</span> <span class="st">"tf-idf"</span>,</span></span>
<span class="r-in"><span>name_merged_clusters <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>cluster_id <span class="op">=</span> <span class="st">"dynamic_cluster_leiden"</span>,</span></span>
<span class="r-in"><span>text_columns <span class="op">=</span> <span class="st">"Title"</span>,</span></span>
<span class="r-in"><span>nb_terms_label <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>clean_word_method <span class="op">=</span> <span class="st">"lemmatise"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>A shallow copy of this data.table was taken so that := can add or remove 2 columns by reference. At an earlier point, this data.table was copied by R (or was created manually using structure() or similar). Avoid names&lt;- and attr&lt;- which in R currently (and oddly) may copy the whole data.table. Use set* syntax instead to avoid copying: ?set, ?setnames and ?setattr. It's also not unusual for data.table-agnostic packages to produce tables affected by this issue. If this message doesn't help, please report your use case to the data.table issue tracker so the root cause can be fixed or this message improved.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temporal_networks</span> <span class="op">&lt;-</span> <span class="fu"><a href="color_networks.html">color_networks</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">temporal_networks</span>,</span></span>
<span class="r-in"><span>column_to_color <span class="op">=</span> <span class="st">"dynamic_cluster_leiden"</span>,</span></span>
<span class="r-in"><span>color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> <span style="font-style: italic;">unique_color_across_list</span> has been set to <span style="color: #0000BB;">FALSE</span>. There are <span style="color: #0000BB;">14</span> different categories to color.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">color</span> is neither a vector of color characters, nor a data.frame. We will proceed with base R colors.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> We draw 7 colors from the <span style="font-style: italic;">ggplot2</span> palette and <span style="color: #0000BB;">7</span> colors from the <span style="font-style: italic;">Okabe-Ito</span> palette.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">alluv_dt</span> <span class="op">&lt;-</span> <span class="fu">networks_to_alluv</span><span class="op">(</span><span class="va">temporal_networks</span>,</span></span>
<span class="r-in"><span>intertemporal_cluster_column <span class="op">=</span> <span class="st">"dynamic_cluster_leiden"</span>,</span></span>
<span class="r-in"><span>node_id <span class="op">=</span> <span class="st">"ID_Art"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">alluv_dt</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    dynamic_cluster_leiden    window     ID_Art   color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;char&gt;    &lt;char&gt;     &lt;char&gt;  &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:                   cl_1 1975-1994   16182155 #F564E3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:                   cl_1 1975-1994   26283591 #F564E3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:                   cl_1 1975-1994   31895842 #F564E3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:                   cl_1 1975-1994 1111111131 #F564E3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:                   cl_1 1975-1994 1111111150 #F564E3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                              cluster_label share_cluster_alluv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                     &lt;char&gt;               &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: controls, controls program, program, price level, level                6.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: controls, controls program, program, price level, level                6.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: controls, controls program, program, price level, level                6.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: controls, controls program, program, price level, level                6.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: controls, controls program, program, price level, level                6.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    share_cluster_window share_cluster_max length_cluster    y_alluv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   &lt;num&gt;             &lt;num&gt;          &lt;int&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:                17.57             18.31              7 0.01351351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:                17.57             18.31              7 0.01351351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:                17.57             18.31              7 0.01351351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:                17.57             18.31              7 0.01351351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:                17.57             18.31              7 0.01351351</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aurélien Goutsmedt, Alexandre Truc.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

